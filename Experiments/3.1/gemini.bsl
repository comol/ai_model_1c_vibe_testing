ВЫБРАТЬ
    ИсточникДанных.Номенклатура КАК Номенклатура,
    МАКСИМУМ(ИсточникДанных.Дата) КАК Дата
ПОМЕСТИТЬ ВТ_ПоследниеДаты
ИЗ
    &ВашаТаблицаЗначений КАК ИсточникДанных
ГДЕ
    ИсточникДанных.Дата <= &НаДату
СГРУППИРОВАТЬ ПО
    ИсточникДанных.Номенклатура
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
    ИсточникДанных.Номенклатура,
    ИсточникДанных.Цена,
    ИсточникДанных.Дата,
    ИсточникДанных.Количество
ИЗ
    &ВашаТаблицаЗначений КАК ИсточникДанных
        ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ПоследниеДаты КАК ПоследниеДаты
        ПО ИсточникДанных.Номенклатура = ПоследниеДаты.Номенклатура
        И ИсточникДанных.Дата = ПоследниеДаты.Дата





Запрос = Новый Запрос;
Запрос.Текст = "ВАШ_ТЕКСТ_ЗАПРОСА_ВЫШЕ";

// Предположим, ВашаТаблица у вас уже заполнена
Запрос.УстановитьПараметр("ВашаТаблицаЗначений", ВашаТаблица); 
Запрос.УстановитьПараметр("НаДату", ТекущаяДата());

Результат = Запрос.Выполнить();