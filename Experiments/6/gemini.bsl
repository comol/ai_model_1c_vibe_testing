&НаКлиенте
Процедура ЗагрузитьИзФайлаНаКлиенте(Команда)

	// Открываем диалог выбора файла Excel
	ДиалогВыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	ДиалогВыбораФайла.Заголовок = "Выберите файл для загрузки";
	ДиалогВыбораФайла.ПолноеИмяФайла = "";
	ДиалогВыбораФайла.Фильтр = "Файл Excel (*.xls, *.xlsx)|*.xls;*.xlsx";
	
	Если ДиалогВыбораФайла.Выбрать() Тогда
		ИмяФайла = ДиалогВыбораФайла.ПолноеИмяФайла;
		
		// Помещаем файл во временное хранилище и вызываем серверную процедуру
		ПоместитьФайл(АдресВХранилище, ИмяФайла, , Ложь, УникальныйИдентификатор);
		ЗагрузитьИзФайлаНаСервере(АдресВХранилище);
	КонецЕсли;

КонецПроцедуры

&НаСервере
Процедура ЗагрузитьИзФайлаНаСервере(АдресВХранилище)

	// Читаем файл Excel из временного хранилища
	ДвоичныеДанные = ПолучитьИзВременногоХранилища(АдресВХранилище);
	ИмяВременногоФайла = ПолучитьИмяВременногоФайла("xlsx");
	ДвоичныеДанные.Записать(ИмяВременногоФайла);

	ТабличныйДокумент = Новый ТабличныйДокумент;
	ТабличныйДокумент.Прочитать(ИмяВременногоФайла);
	
	// Получаем область данных
	Область = ТабличныйДокумент.Область("R2:C" + ТабличныйДокумент.ВысотаТаблицы);
	
	// Обходим строки файла, начиная со второй (первая - заголовок)
	Для Сч = 2 По ТабличныйДокумент.ВысотаТаблицы Цикл
		
		// Получаем данные из ячеек
		Артикул      = СокрЛП(ТабличныйДокумент.Область("A" + Сч).Текст);
		Наименование  = СокрЛП(ТабличныйДокумент.Область("B" + Сч).Текст);
		Описание      = СокрЛП(ТабличныйДокумент.Область("C" + Сч).Текст);
		ЕдИзмерения   = СокрЛП(ТабличныйДокумент.Область("D" + Сч).Текст);

		Если ЗначениеЗаполнено(Артикул) Тогда
			
			// Ищем номенклатуру по артикулу
			НоменклатураОбъект = Справочники.Номенклатура.НайтиПоРеквизиту("Артикул", Артикул).ПолучитьОбъект();

			Если НоменклатураОбъект = Неопределено Тогда
				// Если не нашли, создаем новую
				НоменклатураОбъект = Справочники.Номенклатура.СоздатьЭлемент();
				НоменклатураОбъект.Артикул = Артикул;
			КонецЕсли;

			// Заполняем реквизиты
			НоменклатураОбъект.Наименование = Наименование;
			НоменклатураОбъект.Описание = Описание;

			// Работаем с единицей измерения
			Если ЗначениеЗаполнено(ЕдИзмерения) Тогда
				СсылкаЕдИзм = Справочники.ЕдиницыИзмерения.НайтиПоНаименованию(ЕдИзмерения);
				Если НЕ СсылкаЕдИзм.Пустая() Тогда
					НоменклатураОбъект.ЕдиницаИзмерения = СсылкаЕдИзм;
				Иначе
					// Если единица измерения не найдена, создаем новую
					НоваяЕдИзм = Справочники.ЕдиницыИзмерения.СоздатьЭлемент();
					НоваяЕдИзм.Наименование = ЕдИзмерения;
					НоваяЕдИзм.Записать();
					НоменклатураОбъект.ЕдиницаИзмерения = НоваяЕдИзм.Ссылка;
				КонецЕсли;
			КонецЕсли;

			// Записываем объект
			Попытка
				НоменклатураОбъект.Записать();
			Исключение
				// Обработка возможных ошибок при записи
				ЗаписьЖурналаРегистрации("Ошибка загрузки номенклатуры", 
										  УровеньЖурналаРегистрации.Ошибка, , ,
										  ПодробноеПредставлениеОшибки(ИнформацияОбОшибке()));
			КонецПопытки;
		
		КонецЕсли;
		
	КонецЦикла;
	
	Сообщить("Загрузка данных завершена!");

КонецПроцедуры