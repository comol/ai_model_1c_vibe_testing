// Модуль объекта обработки для загрузки номенклатуры из Excel
// Автор: AI Assistant, Дата: 2024

// Процедура ЗагрузитьНоменклатуруИзExcel(ПутьКФайлу)
// Описание: Загружает данные из Excel-файла в справочник Номенклатура.
// Параметры:
//   ПутьКФайлу - Строка - Полный путь к Excel-файлу.

Процедура ЗагрузитьНоменклатуруИзExcel(ПутьКФайлу) Экспорт

    // Константы для номеров колонок
    КолонкаАртикул = 1;
    КолонкаНаименование = 2;
    КолонкаОписание = 3;
    КолонкаЕдиницаИзмерения = 4;

    // Инициализация COM-объекта Excel
    Excel = Новый COMОбъект("Excel.Application");
    Excel.DisplayAlerts = Ложь; // Отключение предупреждений

    // Открытие книги
    Книга = Excel.Workbooks.Open(ПутьКФайлу);
    Лист = Книга.Sheets(1);

    // Получение количества строк
    КоличествоСтрок = Лист.UsedRange.Rows.Count;

    // Цикл по строкам, начиная со второй (пропуск заголовков)
    Для НомерСтроки = 2 По КоличествоСтрок Цикл

        // Чтение значений из ячеек
        Артикул = СокрЛП(Лист.Cells(НомерСтроки, КолонкаАртикул).Value);
        Наименование = СокрЛП(Лист.Cells(НомерСтроки, КолонкаНаименование).Value);
        Описание = СокрЛП(Лист.Cells(НомерСтроки, КолонкаОписание).Value);
        ЕдиницаИзмерения = СокрЛП(Лист.Cells(НомерСтроки, КолонкаЕдиницаИзмерения).Value);

        // Пропуск пустых строк
        Если ПустаяСтрока(Артикул) Тогда
            Продолжить;
        КонецЕсли;

        // Поиск существующего элемента по артикулу
        Элемент = Справочники.Номенклатура.НайтиПоРеквизиту("Артикул", Артикул);

        Если Элемент.Пустая() Тогда
            // Создание нового элемента
            НовыйЭлемент = Справочники.Номенклатура.СоздатьЭлемент();
        Иначе
            // Получение объекта для редактирования
            НовыйЭлемент = Элемент.ПолучитьОбъект();
        КонецЕсли;

        // Заполнение реквизитов
        НовыйЭлемент.Артикул = Артикул;
        НовыйЭлемент.Наименование = Наименование;
        НовыйЭлемент.Описание = Описание;
        НовыйЭлемент.ЕдиницаИзмерения = ЕдиницаИзмерения; 
        // Предполагается строковый тип; если ссылка - добавить поиск по наименованию

        // Запись элемента
        НовыйЭлемент.Записать();

    КонецЦикла;

    // Закрытие Excel
    Книга.Close(Ложь);
    Excel.Quit();
    Excel = Неопределено;

КонецПроцедуры
