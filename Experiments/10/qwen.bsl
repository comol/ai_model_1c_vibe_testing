// Модуль документа с табличной частью товаров

// Создание документа с тестовыми данными
Процедура СоздатьДокументСТестовымиДанными()
	
	// Создаем таблицу значений для табличной части
	ТаблицаТоваров = Новый ТаблицаЗначений;
	ТаблицаТоваров.Колонки.Добавить("Номенклатура", Новый ОписаниеТипов("Строка"));
	ТаблицаТоваров.Колонки.Добавить("Количество", Новый ОписаниеТипов("Число"));
	ТаблицаТоваров.Колонки.Добавить("Сумма", Новый ОписаниеТипов("Число"));
	ТаблицаТоваров.Колонки.Добавить("Цена", Новый ОписаниеТипов("Число"));
	
	// Заполняем тестовыми данными (более 1000 строк для демонстрации)
	Для НомерСтроки = 1 По 1000 Цикл
		СтрокаТаблицы = ТаблицаТоваров.Добавить();
		СтрокаТаблицы.Номенклатура = "Товар" + НомерСтроки;
		СтрокаТаблицы.Количество = СлучайноеЧисло(1, 100);
		СтрокаТаблицы.Цена = СлучайноеЧисло(100, 10000) / 100;
		СтрокаТаблицы.Сумма = СтрокаТаблицы.Количество * СтрокаТаблицы.Цена;
	КонецЦикла;
	
	// Возвращаем заполненную таблицу
	ФункцияВозврат ТаблицаТоваров;
	
КонецПроцедуры

// Расчет общей суммы по табличной части
Функция РассчитатьОбщуюСумму(ТаблицаТоваров)
	
	// Инициализируем переменную для подсчета суммы
	ОбщаяСумма = 0;
	
	// Проходим по всем строкам табличной части
	Для Каждого СтрокаТаблицы Из ТаблицаТоваров Цикл
		// Проверяем, что значение суммы существует и является числом
		Если ЗначениеЗаполнено(СтрокаТаблицы.Сумма) Тогда
			ОбщаяСумма = ОбщаяСумма + СтрокаТаблицы.Сумма;
		КонецЕсли;
	КонецЦикла;
	
	// Возвращаем результат
	ФункцияВозврат ОбщаяСумма;
	
КонецФункции

// Демонстрация работы с табличной частью
Процедура ДемонстрацияРаботы()
	
	// Создаем тестовые данные
	ТаблицаТоваров = СоздатьДокументСТестовымиДанными();
	
	// Рассчитываем общую сумму
	ОбщаяСумма = РассчитатьОбщуюСумму(ТаблицаТоваров);
	
	// Выводим результат
	Сообщить("Общая сумма по " + ТаблицаТоваров.Количество() + " строкам: " + 
			Формат(ОбщаяСумма, "ЧДЦ=2"));
	
КонецПроцедуры
